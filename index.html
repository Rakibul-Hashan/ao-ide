
<!DOCTYPE html>
<html lang="en" class="theme-dark">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CloudCode IDE</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        darkMode: ['class', '[class*="theme-"]'],
        theme: {
          extend: {
            colors: {
              gray: {
                950: 'var(--bg-app)',
                900: 'var(--bg-panel)',
                800: 'var(--bg-overlay)', 
                750: 'var(--bg-overlay)',
                850: 'var(--bg-panel)',
                100: 'var(--fg-primary)',
                200: 'var(--fg-primary)',
                300: 'var(--fg-secondary)',
                400: 'var(--fg-secondary)',
                500: 'var(--fg-muted)',
              },
              accent: {
                600: 'var(--accent)',
                500: 'var(--accent-hover)',
                400: 'var(--accent-light)',
              }
            },
            fontFamily: {
              mono: ['"Fira Code"', 'ui-monospace', 'SFMono-Regular', 'Menlo', 'Monaco', 'Consolas', 'monospace'],
            }
          },
        },
      }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <style>
      :root {
        /* Default Dark Theme (VS Code Dark+ ish) */
        --bg-app: #0d1117;
        --bg-panel: #111827; 
        --bg-overlay: #1f2937;
        --fg-primary: #f3f4f6;
        --fg-secondary: #9ca3af;
        --fg-muted: #6b7280;
        --accent: #3b82f6;
        --accent-hover: #2563eb;
        --accent-light: #60a5fa;
        
        --editor-bg: #0d1117;
        --editor-fg: #e6edf3;
        --line-num-fg: #6e7681;
        --line-num-bg: #0d1117;
        --selection-bg: rgba(59, 130, 246, 0.3);
      }

      /* Theme: Light */
      .theme-light {
        --bg-app: #f8fafc; /* Crisp Off-White */
        --bg-panel: #ffffff; /* Pure White Panels */
        --bg-overlay: #e2e8f0; /* Light Gray Borders */
        --fg-primary: #0f172a; /* Deep Slate (High Contrast) */
        --fg-secondary: #475569; /* Slate Gray */
        --fg-muted: #94a3b8;
        --accent: #2563eb; /* Strong Blue */
        --accent-hover: #1d4ed8;
        --accent-light: #3b82f6;
        
        --editor-bg: #ffffff;
        --editor-fg: #0f172a;
        --line-num-fg: #cbd5e1;
        --line-num-bg: #f8fafc;
        --selection-bg: rgba(37, 99, 235, 0.1);
      }
      
      /* Enhance Light Mode Inputs & Panels */
      .theme-light input, .theme-light select, .theme-light textarea {
        background-color: #ffffff !important;
        border-color: #cbd5e1 !important;
        color: #0f172a !important;
      }
      .theme-light .bg-gray-900 {
         background-color: var(--bg-panel) !important;
         border-color: var(--bg-overlay) !important;
      }
      .theme-light .bg-gray-950 {
         background-color: var(--bg-app) !important;
      }
      .theme-light ::placeholder {
        color: #94a3b8 !important;
      }

      /* Theme: Dracula */
      .theme-dracula {
        --bg-app: #282a36;
        --bg-panel: #282a36; 
        --bg-overlay: #44475a;
        --fg-primary: #f8f8f2;
        --fg-secondary: #bd93f9; 
        --fg-muted: #6272a4;
        --accent: #ff79c6; 
        --accent-hover: #ff92d0;
        --accent-light: #8be9fd;
        
        --editor-bg: #282a36;
        --editor-fg: #f8f8f2;
        --line-num-fg: #6272a4;
        --line-num-bg: #282a36;
        --selection-bg: #44475a;
      }

      /* Theme: Solarized Dark */
      .theme-solarized {
        --bg-app: #002b36;
        --bg-panel: #073642;
        --bg-overlay: #586e75;
        --fg-primary: #839496;
        --fg-secondary: #93a1a1;
        --fg-muted: #657b83;
        --accent: #b58900; 
        --accent-hover: #cb9b01;
        --accent-light: #2aa198;
        
        --editor-bg: #002b36;
        --editor-fg: #839496;
        --line-num-fg: #586e75;
        --line-num-bg: #073642;
        --selection-bg: #073642;
      }

      /* Theme: Monokai */
      .theme-monokai {
        --bg-app: #272822;
        --bg-panel: #1e1f1c;
        --bg-overlay: #3e3d32;
        --fg-primary: #f8f8f2;
        --fg-secondary: #75715e;
        --fg-muted: #75715e;
        --accent: #a6e22e; 
        --accent-hover: #b7eb46;
        --accent-light: #66d9ef;
        
        --editor-bg: #272822;
        --editor-fg: #f8f8f2;
        --line-num-fg: #90908a;
        --line-num-bg: #272822;
        --selection-bg: #49483e;
      }

      body { 
        font-family: 'Inter', sans-serif; 
        background-color: var(--bg-app);
        color: var(--fg-primary);
      }
      .code-font { font-family: 'Fira Code', monospace; }
      
      ::-webkit-scrollbar {
        width: 14px;
        height: 14px;
      }
      ::-webkit-scrollbar-track {
        background: var(--editor-bg); 
      }
      ::-webkit-scrollbar-thumb {
        background: var(--bg-overlay); 
        border: 3px solid var(--editor-bg);
        border-radius: 7px;
      }
      ::-webkit-scrollbar-thumb:hover {
        background: var(--fg-secondary); 
      }

      /* EDITOR LAYER ALIGNMENT IS CRITICAL */
      .editor-layer {
        font-family: 'Fira Code', monospace !important;
        line-height: 1.5 !important;
        letter-spacing: 0px !important;
        font-variant-ligatures: none !important;
        font-feature-settings: "liga" 0, "calt" 0 !important;
        tab-size: 2 !important;
        box-sizing: border-box !important;
        padding: 1rem !important;
        margin: 0 !important;
        border: 0 !important;
        background: transparent !important;
        overflow-wrap: normal !important;
        /* REMOVED white-space: pre !important; to let JS inline style control wrap */
      }
      
      .editor-overlay textarea {
        caret-color: var(--fg-primary);
        color: transparent !important;
        z-index: 10;
        overflow-y: scroll !important; /* Force scrollbar */
      }
      
      .editor-overlay textarea::selection {
        background: var(--selection-bg);
        color: transparent;
      }

      .editor-overlay pre {
        pointer-events: none;
        z-index: 0;
        overflow-y: scroll !important; /* Match textarea scrollbar */
      }
      
      .editor-overlay pre::-webkit-scrollbar {
        background: transparent;
        width: 14px;
      }
      .editor-overlay pre::-webkit-scrollbar-thumb {
        background: transparent; /* Transparent scrollbar track to align width */
        border: none;
      }
      
      .editor-overlay pre code {
        font-family: inherit !important;
      }

      /* Input Reset */
      .explorer-input {
        background: var(--bg-panel);
        border: 1px solid var(--accent);
        color: var(--fg-primary);
        outline: none;
        font-family: inherit;
        font-size: 0.875rem;
        padding: 2px 4px;
        width: 100%;
        border-radius: 2px;
      }

      .squiggle-error {
        text-decoration: underline wavy #ef4444;
        text-decoration-thickness: 1px;
        text-underline-offset: 3px;
        cursor: help;
      }
      
      .suggestions-popup {
        position: absolute;
        background: var(--bg-overlay);
        border: 1px solid var(--bg-panel);
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.5);
        border-radius: 6px;
        z-index: 50;
        max-height: 200px;
        overflow-y: auto;
        min-width: 200px;
        display: flex;
        flex-direction: column;
      }
      
      .suggestion-item {
        padding: 6px 12px;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 13px;
        color: var(--fg-secondary);
        font-family: 'Fira Code', monospace;
      }
      
      .suggestion-item:hover, .suggestion-item.active {
        background: var(--accent);
        color: white;
      }
      
      .hover-card {
        background: var(--bg-panel);
        border: 1px solid var(--bg-overlay);
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        border-radius: 4px;
        padding: 8px 12px;
        z-index: 100;
        max-width: 350px;
        font-size: 12px;
        line-height: 1.5;
        color: var(--fg-primary);
        pointer-events: none;
        font-family: 'Inter', sans-serif;
        white-space: pre-wrap;
      }
      
      .hover-card .hover-code {
        font-family: 'Fira Code', monospace;
        background: var(--bg-app);
        padding: 2px 4px;
        border-radius: 3px;
        color: var(--accent-light);
        display: inline-block;
        margin-bottom: 4px;
      }
      
      .hover-card .hover-desc {
        color: var(--fg-secondary);
      }

      .cursor-caret {
        position: absolute;
        width: 2px;
        background-color: var(--accent);
        animation: blink 1s step-end infinite;
        pointer-events: none;
        z-index: 20;
      }
      @keyframes blink {
        0%, 100% { opacity: 1; }
        50% { opacity: 0; }
      }
      
      /* Toast Notifications */
      .toast-container {
        position: fixed;
        bottom: 20px;
        right: 20px;
        z-index: 9999;
        display: flex;
        flex-direction: column;
        gap: 10px;
      }
      .toast {
        background-color: var(--bg-panel);
        border: 1px solid var(--bg-overlay);
        border-left: 4px solid var(--accent);
        color: var(--fg-primary);
        padding: 12px 16px;
        border-radius: 4px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        font-size: 0.875rem;
        display: flex;
        align-items: center;
        gap: 12px;
        min-width: 250px;
        animation: slideIn 0.3s ease-out;
      }
      @keyframes slideIn {
        from { transform: translateX(100%); opacity: 0; }
        to { transform: translateX(0); opacity: 1; }
      }

      /* PRISM OVERRIDES */
      /* Light Mode Syntax - Higher Contrast */
      .theme-light .token.comment,
      .theme-light .token.prolog,
      .theme-light .token.doctype,
      .theme-light .token.cdata { color: #6a737d; font-style: italic; }
      .theme-light .token.punctuation { color: #24292e; }
      .theme-light .token.property,
      .theme-light .token.tag,
      .theme-light .token.boolean,
      .theme-light .token.number,
      .theme-light .token.constant,
      .theme-light .token.symbol,
      .theme-light .token.deleted { color: #d73a49; }
      .theme-light .token.selector,
      .theme-light .token.attr-name,
      .theme-light .token.string,
      .theme-light .token.char,
      .theme-light .token.builtin,
      .theme-light .token.inserted { color: #032f62; }
      .theme-light .token.operator,
      .theme-light .token.entity,
      .theme-light .token.url,
      .theme-light .language-css .token.string,
      .theme-light .style .token.string { color: #005cc5; }
      .theme-light .token.atrule,
      .theme-light .token.attr-value,
      .theme-light .token.keyword { color: #d73a49; font-weight: bold; }
      .theme-light .token.function,
      .theme-light .token.class-name { color: #6f42c1; font-weight: bold; }

      /* Dracula Syntax Overrides */
      .theme-dracula .token.comment { color: #6272a4; }
      .theme-dracula .token.keyword { color: #ff79c6; }
      .theme-dracula .token.string { color: #f1fa8c; }
      .theme-dracula .token.function { color: #50fa7b; }
      .theme-dracula .token.number { color: #bd93f9; }
      .theme-dracula .token.class-name { color: #8be9fd; }

      /* Solarized Syntax Overrides */
      .theme-solarized .token.comment { color: #586e75; }
      .theme-solarized .token.keyword { color: #859900; }
      .theme-solarized .token.string { color: #2aa198; }
      .theme-solarized .token.function { color: #268bd2; }
      
      /* Monokai Syntax Overrides */
      .theme-monokai .token.comment { color: #75715e; }
      .theme-monokai .token.keyword { color: #f92672; }
      .theme-monokai .token.string { color: #e6db74; }
      .theme-monokai .token.function { color: #a6e22e; }
    </style>
    <script type="importmap">
{
  "imports": {
    "react-dom/": "https://aistudiocdn.com/react-dom@^19.2.0/",
    "react/": "https://aistudiocdn.com/react@^19.2.0/",
    "react": "https://aistudiocdn.com/react@^19.2.0",
    "@google/genai": "https://aistudiocdn.com/@google/genai@^1.30.0",
    "lucide-react": "https://aistudiocdn.com/lucide-react@^0.554.0",
    "prismjs": "https://esm.sh/prismjs@1.29.0",
    "prismjs/": "https://esm.sh/prismjs@1.29.0/",
    "jszip": "https://esm.sh/jszip@3.10.1"
  }
}
</script>
<link rel="stylesheet" href="/index.css">
</head>
  <body>
    <div id="root"></div>
  <script type="module" src="/index.tsx"></script>
</body>
</html>
